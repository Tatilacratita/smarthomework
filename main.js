const translations = {
  ro: {
    nav: {
      privacy: 'Politica de confidențialitate',
      home: 'Acasă'
    },
    hero: {
      title: 'Fă-ți temele mai ușor cu ajutorul AI!',
      subtitle: 'Scanează, întreabă și primește explicații clare instant. SmartHomework folosește inteligența artificială pentru a-ți face învățarea mai simplă.',
      download: 'Descarcă aplicația',
      learn: 'Descoperă mai mult'
    },
    features: {
      title: 'Despre SmartHomework',
      subtitle: 'O aplicație completă pentru a-ți face temele mai eficient',
      ocr: {
        title: 'Recunoaștere text din poze (OCR)',
        desc: 'Fotografiază exercițiul și lasă aplicația să extragă textul automat pentru tine.'
      },
      ai: {
        title: 'Înțelege subiectul automat',
        desc: 'AI-ul identifică materia și contextul pentru a-ți oferi răspunsuri precise.'
      },
      explain: {
        title: 'Explicații clare cu AI',
        desc: 'Primești explicații pas cu pas, ușor de înțeles, adaptate nivelului tău.'
      },
      tts: {
        title: 'Citește cu voce (Text-to-Speech)',
        desc: 'Ascultă explicațiile în loc să citești, perfect pentru învățare audio.'
      },
      stt: {
        title: 'Vorbește cu aplicația',
        desc: 'Pune întrebări direct cu vocea ta prin Speech-to-Text.'
      },
      history: {
        title: 'Istoric teme rezolvate',
        desc: 'Toate temele tale sunt salvate local cu Hive storage pentru acces rapid.'
      }
    },
    how: {
      title: 'Cum funcționează',
      step1: {
        title: 'Scanează exercițiul',
        desc: 'Fă o poză clară exercițiului din caiet sau manual'
      },
      step2: {
        title: 'AI procesează',
        desc: 'Inteligența artificială analizează și înțelege cerința'
      },
      step3: {
        title: 'Vezi soluția',
        desc: 'Primești explicații clare, pas cu pas'
      },
      step4: {
        title: 'Salvează în istoric',
        desc: 'Accesează oricând temele rezolvate anterior'
      }
    },
    download: {
      title: 'Descarcă SmartHomework acum',
      subtitle: 'Disponibil gratuit pe iOS și Android',
      available: 'Disponibil pe',
      get: 'Descarcă de pe'
    },
    footer: {
      tagline: 'Învățare inteligentă cu AI',
      links: 'Link-uri rapide',
      privacy: 'Politica de confidențialitate',
      contact: 'Contact',
      copyright: '© 2025 SmartHomework. Toate drepturile rezervate.'
    },
    privacy: {
      title: 'Politică de Confidențialitate SmartHomework',
      date: 'Data intrării în vigoare: 24 octombrie 2025',
      intro: 'Această Politică de Confidențialitate descrie cum colectează, folosește, stochează și protejează aplicația noastră mobilă SmartHomework (denumită în continuare "aplicația", "noi") informațiile dumneavoastră.',
      agreement: 'Prin utilizarea aplicației SmartHomework, sunteți de acord cu practicile descrise în această politică.',
      section1: {
        title: '1. Informațiile pe care le colectăm',
        intro: 'Scopul principal al aplicației SmartHomework este să vă ajute cu temele, fără a compromite confidențialitatea. Colectăm o cantitate minimă de informații.',
        photos: {
          title: 'Fotografii și Text:',
          item1: {
            label: 'Fotografiile pe care le faceți:',
            text: 'Aplicația accesează camera pentru a fotografia exercițiile. Fotografiile în sine NU sunt salvate sau trimise pe serverele noastre. Ele sunt procesate local, pe dispozitivul dumneavoastră, pentru recunoașterea textului (OCR).'
          },
          item2: {
            label: 'Textul recunoscut (OCR):',
            text: 'Textul extras din fotografii este folosit strict pentru a vă oferi funcționalitățile aplicației (explicații AI, citire cu vocea, etc.).'
          }
        },
        voice: {
          title: 'Interacțiunea vocală:',
          item1: {
            label: 'Intrări vocale (Speech-to-Text):',
            text: 'Când vorbiți cu aplicația pentru a pune o întrebare, audio-ul este convertit în text pe dispozitivul dumneavoastră sau prin servicii securizate de recunoaștere vocală. Nu înregistrăm sau stocăm convorbirile dumneavoastră vocale.'
          }
        },
        local: {
          title: 'Date stocate local:',
          item1: {
            label: 'Istoricul temelor:',
            text: 'Aplicația salvează un istoric al temelor și exercițiilor rezolvate pe dispozitivul dumneavoastră, folosind Hive local storage. Aceste date rămân pe dispozitivul dumneavoastră și nu sunt sincronizate cu niciun server extern. Doar dumneavoastră aveți acces la acest istoric.'
          }
        }
      },
      section2: {
        title: '2. Cum folosim informațiile',
        intro: 'Informațiile colectate sunt utilizate exclusiv pentru a oferi funcționalitățile de bază ale aplicației:',
        item1: 'Pentru a recunoaște textul din fotografiile dumneavoastră (OCR).',
        item2: 'Pentru a procesa întrebările dumneavoastră (prin text sau voce) și a genera explicații cu ajutorul AI.',
        item3: 'Pentru a citi textul cu voce tare (Text-to-Speech).',
        item4: 'Pentru a vă salva și afișa istoricul temelor local, pe dispozitiv.'
      },
      section3: {
        title: '3. Partajarea informațiilor',
        p1: 'Nu vindem, nu închiriem și nu partajăm datele dumneavoastră cu terțe părți.',
        p2: 'Pentru anumite funcționalități esențiale (cum ar fi generarea de explicații prin AI), aplicația poate trimise doar textul dumneavoastră către un furnizor de servicii de AI (de exemplu, serverele OpenAI sau alte alternative). Acest transfer se face prin conexiuni securizate (HTTPS), iar textul este procesat fără a fi stocat permanent pe aceste servere. Nu asociem aceste cereri cu identitatea sau dispozitivul dumneavoastră.'
      },
      section4: {
        title: '4. Stocarea și securitatea datelor',
        item1: {
          label: 'Stocare locală:',
          text: 'Istoricul temelor, setările și alte date personale rămân stocate în siguranță doar pe dispozitivul dumneavoastră.'
        },
        item2: {
          label: 'Fără cont:',
          text: 'Nu este necesar să vă creați un cont pentru a utiliza aplicația, ceea ce elimină necesitatea stocării de date personale de identificare.'
        },
        item3: {
          label: 'Procesare pe dispozitiv:',
          text: 'Procesele critice de OCR și Speech-to-Text se desfășoară, pe cât posibil, direct pe telefon, minimizând transferul de date.'
        }
      },
      section5: {
        title: '5. Drepturile dumneavoastră',
        intro: 'Deoarece datele dumneavoastră rămân pe dispozitiv, aveți control deplin asupra lor.',
        item1: 'Puteți șterge istoricul temelor oricând direct din setările aplicației.',
        item2: 'Puteți dezinstala aplicația pentru a șterge toate datele asociate.'
      },
      section6: {
        title: '6. Modificări la această politică de confidențialitate',
        text: 'Putem actualiza această Politică de Confidențialitate din când în când. Vă vom notifica despre orice modificare prin postarea noii Politici de Confidențialitate în aplicație. Vă rugăm să verificați periodic această Politică de Confidențialitate pentru orice modificare.'
      },
      section7: {
        title: '7. Contactați-ne',
        text: 'Dacă aveți întrebări sau nelămuriri despre această Politică de Confidențialitate, vă rugăm să ne contactați la:'
      }
    }
  },
  en: {
    nav: {
      privacy: 'Privacy Policy',
      home: 'Home'
    },
    hero: {
      title: 'Make homework easier with AI!',
      subtitle: 'Scan, ask and get clear explanations instantly. SmartHomework uses artificial intelligence to make learning simpler.',
      download: 'Download app',
      learn: 'Learn more'
    },
    features: {
      title: 'About SmartHomework',
      subtitle: 'A complete app to do your homework more efficiently',
      ocr: {
        title: 'Text recognition from photos (OCR)',
        desc: 'Take a photo of the exercise and let the app extract the text automatically for you.'
      },
      ai: {
        title: 'Understands the subject automatically',
        desc: 'AI identifies the subject and context to give you precise answers.'
      },
      explain: {
        title: 'Clear explanations with AI',
        desc: 'Get step-by-step explanations, easy to understand, adapted to your level.'
      },
      tts: {
        title: 'Read aloud (Text-to-Speech)',
        desc: 'Listen to explanations instead of reading, perfect for audio learning.'
      },
      stt: {
        title: 'Talk to the app',
        desc: 'Ask questions directly with your voice through Speech-to-Text.'
      },
      history: {
        title: 'Solved homework history',
        desc: 'All your homework is saved locally with Hive storage for quick access.'
      }
    },
    how: {
      title: 'How it works',
      step1: {
        title: 'Scan exercise',
        desc: 'Take a clear photo of the exercise from notebook or textbook'
      },
      step2: {
        title: 'AI processes',
        desc: 'Artificial intelligence analyzes and understands the requirement'
      },
      step3: {
        title: 'See solution',
        desc: 'Get clear, step-by-step explanations'
      },
      step4: {
        title: 'Save to history',
        desc: 'Access previously solved homework anytime'
      }
    },
    download: {
      title: 'Download SmartHomework now',
      subtitle: 'Available for free on iOS and Android',
      available: 'Available on',
      get: 'Get it on'
    },
    footer: {
      tagline: 'Smart learning with AI',
      links: 'Quick links',
      privacy: 'Privacy Policy',
      contact: 'Contact',
      copyright: '© 2025 SmartHomework. All rights reserved.'
    },
    privacy: {
      title: 'SmartHomework Privacy Policy',
      date: 'Effective date: October 24, 2025',
      intro: 'This Privacy Policy describes how our mobile application SmartHomework (hereinafter referred to as "the application", "we") collects, uses, stores and protects your information.',
      agreement: 'By using the SmartHomework application, you agree to the practices described in this policy.',
      section1: {
        title: '1. Information we collect',
        intro: 'The main purpose of the SmartHomework application is to help you with homework, without compromising privacy. We collect a minimal amount of information.',
        photos: {
          title: 'Photos and Text:',
          item1: {
            label: 'Photos you take:',
            text: 'The app accesses the camera to photograph exercises. The photos themselves are NOT saved or sent to our servers. They are processed locally, on your device, for text recognition (OCR).'
          },
          item2: {
            label: 'Recognized text (OCR):',
            text: 'Text extracted from photos is used strictly to provide you with app functionalities (AI explanations, voice reading, etc.).'
          }
        },
        voice: {
          title: 'Voice interaction:',
          item1: {
            label: 'Voice inputs (Speech-to-Text):',
            text: 'When you speak to the app to ask a question, the audio is converted to text on your device or through secure voice recognition services. We do not record or store your voice conversations.'
          }
        },
        local: {
          title: 'Locally stored data:',
          item1: {
            label: 'Homework history:',
            text: 'The app saves a history of solved homework and exercises on your device, using Hive local storage. This data remains on your device and is not synchronized with any external server. Only you have access to this history.'
          }
        }
      },
      section2: {
        title: '2. How we use information',
        intro: 'The collected information is used exclusively to provide basic app functionalities:',
        item1: 'To recognize text from your photos (OCR).',
        item2: 'To process your questions (via text or voice) and generate explanations using AI.',
        item3: 'To read text aloud (Text-to-Speech).',
        item4: 'To save and display your homework history locally, on device.'
      },
      section3: {
        title: '3. Information sharing',
        p1: 'We do not sell, rent or share your data with third parties.',
        p2: 'For certain essential functionalities (such as generating AI explanations), the app may send only your text to an AI service provider (for example, OpenAI servers or other alternatives). This transfer is done through secure connections (HTTPS), and the text is processed without being permanently stored on these servers. We do not associate these requests with your identity or device.'
      },
      section4: {
        title: '4. Data storage and security',
        item1: {
          label: 'Local storage:',
          text: 'Homework history, settings and other personal data remain safely stored only on your device.'
        },
        item2: {
          label: 'No account:',
          text: 'It is not necessary to create an account to use the app, which eliminates the need to store personal identification data.'
        },
        item3: {
          label: 'On-device processing:',
          text: 'Critical OCR and Speech-to-Text processes take place, as much as possible, directly on the phone, minimizing data transfer.'
        }
      },
      section5: {
        title: '5. Your rights',
        intro: 'Since your data remains on the device, you have full control over it.',
        item1: 'You can delete homework history anytime directly from app settings.',
        item2: 'You can uninstall the app to delete all associated data.'
      },
      section6: {
        title: '6. Changes to this privacy policy',
        text: 'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy in the app. Please check this Privacy Policy periodically for any changes.'
      },
      section7: {
        title: '7. Contact us',
        text: 'If you have questions or concerns about this Privacy Policy, please contact us at:'
      }
    }
  }
};

let currentLang = 'ro';

function translatePage() {
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(element => {
    const key = element.getAttribute('data-i18n');
    const keys = key.split('.');
    let value = translations[currentLang];

    for (const k of keys) {
      if (value && value[k]) {
        value = value[k];
      } else {
        value = null;
        break;
      }
    }

    if (value && typeof value === 'string') {
      element.textContent = value;
    }
  });

  document.documentElement.lang = currentLang;
  
  // Actualizează și atributele alt și title pentru SVG-uri dacă este necesar
  updateSvgAccessibility();
}

function updateSvgAccessibility() {
  const svgs = document.querySelectorAll('svg');
  svgs.forEach(svg => {
    if (!svg.getAttribute('aria-label')) {
      svg.setAttribute('aria-hidden', 'true');
    }
  });
}

function setupLanguageToggle() {
  const langToggle = document.getElementById('langToggle');
  if (!langToggle) return;

  langToggle.addEventListener('click', () => {
    const langOptions = langToggle.querySelectorAll('.lang-option');

    langOptions.forEach(option => {
      option.classList.toggle('active');
    });

    currentLang = currentLang === 'ro' ? 'en' : 'ro';
    translatePage();
    
    // Salvează preferința în localStorage
    localStorage.setItem('preferredLang', currentLang);
  });
}

function setupScrollAnimations() {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { 
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  });

  const animatedElements = document.querySelectorAll('.fade-in');
  animatedElements.forEach(el => observer.observe(el));
}

function setupSmoothScroll() {
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const targetId = this.getAttribute('href');
      const target = document.querySelector(targetId);
      
      if (target) {
        const headerOffset = 80;
        const elementPosition = target.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });
      }
    });
  });
}

function setupNavigation() {
  // Highlight active navigation link
  const navLinks = document.querySelectorAll('.nav-link');
  const currentPage = window.location.pathname;
  
  navLinks.forEach(link => {
    if (link.getAttribute('href') === currentPage) {
      link.style.color = 'var(--primary)';
      link.style.fontWeight = '600';
    }
  });
}

function setupStoreButtons() {
  const storeButtons = document.querySelectorAll('.store-button');
  
  storeButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      e.preventDefault();
      // Aici poți adăuga logica pentru redirecționare către App Store/Google Play
      alert('Link-urile către App Store și Google Play vor fi adăugate când aplicația va fi publicată.');
    });
  });
}

function loadPreferredLanguage() {
  const savedLang = localStorage.getItem('preferredLang');
  if (savedLang && (savedLang === 'ro' || savedLang === 'en')) {
    currentLang = savedLang;
    
    // Actualizează butonul de limbă
    const langToggle = document.getElementById('langToggle');
    if (langToggle) {
      const langOptions = langToggle.querySelectorAll('.lang-option');
      langOptions.forEach(option => {
        option.classList.toggle('active', option.getAttribute('data-lang') === currentLang);
      });
    }
  }
}

function initializeApp() {
  loadPreferredLanguage();
  setupLanguageToggle();
  setupScrollAnimations();
  setupSmoothScroll();
  setupNavigation();
  setupStoreButtons();
  translatePage();
  
  // Animați inițiale pentru elementele deja în viewport
  setTimeout(() => {
    const elementsInViewport = document.querySelectorAll('.fade-in');
    elementsInViewport.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) {
        el.classList.add('visible');
      }
    });
  }, 100);
}

// Inițializează aplicația când DOM-ul este gata
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeApp);
} else {
  initializeApp();
}

// Handle page transitions and back button
window.addEventListener('pageshow', (event) => {
  if (event.persisted) {
    initializeApp();
  }
});

// Adaugă un mic delay pentru a asigura că totul este încărcat
window.addEventListener('load', () => {
  setTimeout(initializeApp, 50);
});
